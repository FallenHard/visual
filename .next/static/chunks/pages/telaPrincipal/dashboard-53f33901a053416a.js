(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[239],{754:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/telaPrincipal/dashboard",function(){return o(109)}])},109:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return n}});var s=o(5893),t=o(7294),r=o(9923);function n(){let[e,a]=(0,t.useState)("novo"),[o,n]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[l,d]=(0,t.useState)([]),[h,m]=(0,t.useState)(""),v=(0,r.s0)(),[p,g]=(0,t.useState)({servicoId:"",proprietarioId:"",dataHora:"",observacao:""}),[u,x]=(0,t.useState)(new Date),[j,b]=(0,t.useState)("");(0,t.useEffect)(()=>{N()},[]);let N=async()=>{console.log("[v0] Iniciando carregamento de dados...");let e=localStorage.getItem("token");if(e)try{let a=JSON.parse(atob(e.split(".")[1]))["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||"";m(a),console.log("[v0] User role:",a)}catch(e){console.log("[v0] Erro ao decodificar token:",e)}try{console.log("[v0] Buscando servi\xe7os em: http://localhost:5069/api/Servicos/todos");let e=await fetch("http://localhost:5069/api/Servicos/todos");if(console.log("[v0] Status da resposta de servi\xe7os:",e.status),e.ok){let a=await e.json();console.log("[v0] Servi\xe7os recebidos da API:",a),n(a)}else console.log("[v0] Resposta n\xe3o OK para servi\xe7os"),n([])}catch(e){console.log("[v0] Erro ao carregar servi\xe7os:",e.message),n([])}try{console.log("[v0] Buscando propriet\xe1rios em: http://localhost:5069/api/Proprietarios/todos");let e=await fetch("http://localhost:5069/api/Proprietarios/todos");if(console.log("[v0] Status da resposta de propriet\xe1rios:",e.status),e.ok){let a=await e.json();console.log("[v0] Propriet\xe1rios recebidos da API:",a),c(a)}else console.log("[v0] Resposta n\xe3o OK para propriet\xe1rios"),c([])}catch(e){console.log("[v0] Erro ao carregar barbeiros:",e.message),c([])}try{console.log("[v0] Buscando agendamentos em: http://localhost:5069/api/Agendamento/todos");let e=await fetch("http://localhost:5069/api/Agendamento/todos");if(console.log("[v0] Status da resposta de agendamentos:",e.status),e.ok){let a=await e.json();console.log("[v0] Agendamentos recebidos da API:",a),d(a)}}catch(e){console.log("[v0] Erro ao carregar agendamentos:",e.message)}},f=async e=>{e.preventDefault();let s=o.find(e=>e.id===p.servicoId);if(!s){alert("Por favor, selecione um servi\xe7o.");return}let t="".concat(u.toISOString().split("T")[0],"T").concat(j,":00"),r={clienteId:1,proprietarioId:p.proprietarioId,servicoId:p.servicoId,dataHora:t,observacao:p.observacao||"",precoFinal:s.preco,confirmado:!1};try{let e=await fetch("http://localhost:5069/api/Agendamento/criar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(e.ok){let o=await e.json();alert(o.message||"Agendamento realizado com sucesso!"),g({servicoId:"",proprietarioId:"",dataHora:"",observacao:""}),b(""),N(),a("meus")}else{let a=await e.text();alert("Erro ao realizar agendamento: ".concat(a))}}catch(e){console.error("Erro ao criar agendamento:",e),alert("Erro ao realizar agendamento. Verifique se a API est\xe1 rodando.")}};return(0,s.jsxs)("div",{className:"dashboard-container",children:[(0,s.jsxs)("div",{className:"dashboard-header",children:[(0,s.jsx)("h1",{className:"dashboard-title",children:"Agendamentos"}),(0,s.jsx)("p",{className:"dashboard-subtitle",children:"Agende seu hor\xe1rio com os melhores profissionais"})]}),(0,s.jsxs)("div",{className:"dashboard-tabs",children:[(0,s.jsx)("button",{className:"tab-button ".concat("novo"===e?"active":""),onClick:()=>a("novo"),children:"Novo Agendamento"}),(0,s.jsx)("button",{className:"tab-button ".concat("meus"===e?"active":""),onClick:()=>a("meus"),children:"Meus Agendamentos"})]}),"novo"===e?(0,s.jsx)("div",{className:"dashboard-content",children:(0,s.jsxs)("div",{className:"booking-grid",children:[(0,s.jsxs)("div",{className:"booking-section",children:[(0,s.jsx)("h2",{className:"section-title",children:"Escolha o Servi\xe7o"}),0===o.length?(0,s.jsx)("div",{className:"empty-state",children:(0,s.jsx)("p",{children:"Nenhum servi\xe7o cadastrado. Verifique se a API est\xe1 rodando e se h\xe1 servi\xe7os no banco de dados."})}):(0,s.jsx)("div",{className:"services-grid",children:o.map(e=>(0,s.jsxs)("div",{className:"service-card ".concat(p.servicoId===e.id?"selected":""),onClick:()=>g({...p,servicoId:e.id}),children:[(0,s.jsx)("h3",{children:e.nome}),(0,s.jsxs)("p",{className:"service-price",children:["R$ ",e.preco.toFixed(2)]})]},e.id))})]}),(0,s.jsxs)("div",{className:"booking-section",children:[(0,s.jsx)("h2",{className:"section-title",children:"Escolha o Barbeiro"}),0===i.length?(0,s.jsx)("div",{className:"empty-state",children:(0,s.jsx)("p",{children:"Nenhum barbeiro cadastrado. Verifique se a API est\xe1 rodando e se h\xe1 propriet\xe1rios no banco de dados."})}):(0,s.jsx)("div",{className:"barbers-grid",children:i.map(e=>(0,s.jsxs)("div",{className:"barber-card ".concat(p.proprietarioId===e.id?"selected":""),onClick:()=>g({...p,proprietarioId:e.id}),children:[(0,s.jsx)("div",{className:"barber-avatar",children:e.nome.charAt(0)}),(0,s.jsx)("h3",{children:e.nome})]},e.id))})]}),(0,s.jsxs)("div",{className:"booking-section",children:[(0,s.jsx)("h2",{className:"section-title",children:"Escolha a Data"}),(()=>{let e=new Date,a=new Date(u.getFullYear(),u.getMonth(),1),o=new Date(u.getFullYear(),u.getMonth()+1,0),t=[],r=a.getDay();for(let e=0;e<r;e++)t.push((0,s.jsx)("div",{className:"calendar-day empty"},"empty-".concat(e)));for(let a=1;a<=o.getDate();a++){let o=new Date(u.getFullYear(),u.getMonth(),a),r=o.toDateString()===u.toDateString(),n=o<e.setHours(0,0,0,0);t.push((0,s.jsx)("div",{className:"calendar-day ".concat(r?"selected":""," ").concat(n?"past":""),onClick:()=>!n&&x(o),children:a},a))}return(0,s.jsxs)("div",{className:"calendar-container",children:[(0,s.jsxs)("div",{className:"calendar-header",children:[(0,s.jsx)("button",{onClick:()=>x(new Date(u.getFullYear(),u.getMonth()-1)),className:"calendar-nav",children:"←"}),(0,s.jsx)("h3",{children:u.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),(0,s.jsx)("button",{onClick:()=>x(new Date(u.getFullYear(),u.getMonth()+1)),className:"calendar-nav",children:"→"})]}),(0,s.jsx)("div",{className:"calendar-weekdays",children:["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map(e=>(0,s.jsx)("div",{className:"weekday",children:e},e))}),(0,s.jsx)("div",{className:"calendar-grid",children:t})]})})()]}),(0,s.jsxs)("div",{className:"booking-section",children:[(0,s.jsx)("h2",{className:"section-title",children:"Escolha o Hor\xe1rio"}),(0,s.jsx)("div",{className:"time-grid",children:["09:00","09:30","10:00","10:30","11:00","11:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30"].map(e=>(0,s.jsx)("button",{className:"time-slot ".concat(j===e?"selected":""),onClick:()=>b(e),children:e},e))})]}),(0,s.jsxs)("div",{className:"booking-section full-width",children:[(0,s.jsx)("h2",{className:"section-title",children:"Observa\xe7\xf5es (Opcional)"}),(0,s.jsx)("textarea",{className:"barber-textarea",placeholder:"Alguma prefer\xeancia ou observa\xe7\xe3o?",value:p.observacao,onChange:e=>g({...p,observacao:e.target.value}),rows:"4"})]}),(0,s.jsx)("div",{className:"booking-section full-width",children:(0,s.jsx)("button",{className:"barber-button",onClick:f,disabled:!p.servicoId||!p.proprietarioId||!j,children:"Confirmar Agendamento"})})]})}):(0,s.jsx)("div",{className:"dashboard-content",children:(0,s.jsx)("div",{className:"appointments-list",children:0===l.length?(0,s.jsx)("div",{className:"empty-state",children:(0,s.jsx)("p",{children:"Voc\xea ainda n\xe3o tem agendamentos."})}):l.map(e=>{var a,o,t;return(0,s.jsxs)("div",{className:"appointment-card",children:[(0,s.jsxs)("div",{className:"appointment-header",children:[(0,s.jsx)("h3",{children:(null===(a=e.servico)||void 0===a?void 0:a.nome)||"Servi\xe7o"}),(0,s.jsx)("span",{className:"status-badge ".concat(e.confirmado?"confirmed":"pending"),children:e.confirmado?"Confirmado":"Pendente"})]}),(0,s.jsxs)("div",{className:"appointment-details",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Barbeiro:"})," ",(null===(o=e.proprietario)||void 0===o?void 0:o.nome)||"N/A"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Data/Hora:"})," ",new Date(e.dataHora).toLocaleString("pt-BR")]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Pre\xe7o:"})," R$ ",(null===(t=e.precoFinal)||void 0===t?void 0:t.toFixed(2))||"0.00"]}),e.observacao&&(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Observa\xe7\xe3o:"})," ",e.observacao]})]})]},e.id)})})}),"Proprietario"===h&&(0,s.jsxs)("button",{className:"admin-button",onClick:()=>{console.log("[v0] Admin button clicked, navigating to /admin/agendamentos"),v("/admin/agendamentos")},children:[(0,s.jsx)("span",{children:"\uD83D\uDC64"}),(0,s.jsx)("span",{children:"Painel Admin"})]})]})}o(8295),o(9996)},8295:function(){},9996:function(){}},function(e){e.O(0,[434,888,774,179],function(){return e(e.s=754)}),_N_E=e.O()}]);