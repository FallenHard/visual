(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{5175:function(a,e,s){Promise.resolve().then(s.bind(s,2995))},9376:function(a,e,s){"use strict";var t=s(5475);s.o(t,"useRouter")&&s.d(e,{useRouter:function(){return t.useRouter}})},2995:function(a,e,s){"use strict";s.r(e),s.d(e,{default:function(){return l}});var t=s(7437),i=s(2265),n=s(9376);function l(){let[a,e]=(0,i.useState)([]),[s,l]=(0,i.useState)(!0),[r,o]=(0,i.useState)("todos");(0,n.useRouter)(),(0,i.useEffect)(()=>{let a=localStorage.getItem("token");if(!a){alert("Fa\xe7a login para acessar o painel."),navigate("/login");return}try{let e=JSON.parse(atob(a.split(".")[1]))["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||"";if("Proprietario"!==e){alert("Acesso restrito aos propriet\xe1rios."),navigate("/dashboard");return}}catch(a){navigate("/login");return}c()},[]);let c=async()=>{let a=localStorage.getItem("token");l(!0);try{let s=await fetch("https://localhost:7037/api/Agendamento/todos-admin",{headers:{Authorization:"Bearer ".concat(a)}});if(!s.ok){if(401===s.status||403===s.status){alert("Sess\xe3o expirada ou sem permiss\xe3o."),navigate("/login");return}let a=await s.text();throw Error(a||"Falha ao carregar agendamentos")}let t=await s.json(),i=(Array.isArray(t)?t:[]).map(a=>{var e,s,t,i,n;return{id:a.id,servicoNome:(null===(e=a.servico)||void 0===e?void 0:e.nome)||"Servi\xe7o",clienteNome:(null===(s=a.cliente)||void 0===s?void 0:s.nome)||"N/A",proprietarioNome:(null===(t=a.proprietario)||void 0===t?void 0:t.nome)||"N/A",dataHora:a.dataHora,precoFinal:null!==(i=a.precoFinal)&&void 0!==i?i:0,observacoes:null!==(n=a.observacao)&&void 0!==n?n:"",status:a.confirmado?"Confirmado":"Pendente"}});e(i)}catch(a){console.error("Erro ao buscar agendamentos:",a),alert("Erro ao carregar agendamentos.")}finally{l(!1)}},d=a.filter(a=>{var e;return"todos"===r||(null===(e=a.status)||void 0===e?void 0:e.toLowerCase())===r}),m={total:a.length,confirmados:a.filter(a=>{var e;return(null===(e=a.status)||void 0===e?void 0:e.toLowerCase())==="confirmado"}).length,pendentes:a.filter(a=>{var e;return(null===(e=a.status)||void 0===e?void 0:e.toLowerCase())==="pendente"}).length,receita:a.reduce((a,e)=>a+(e.precoFinal||0),0)},h=a=>new Date(a).toLocaleDateString("pt-BR"),u=a=>new Date(a).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});return(0,t.jsxs)("div",{className:"admin-container",children:[(0,t.jsxs)("header",{className:"admin-header",children:[(0,t.jsx)("button",{className:"admin-back-btn",onClick:()=>navigate("/dashboard"),children:"← Voltar"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"admin-title",children:"Painel Administrativo"}),(0,t.jsx)("p",{className:"admin-subtitle",children:"Gerencie todos os agendamentos da barbearia"})]})]}),(0,t.jsxs)("div",{className:"admin-stats",children:[(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("div",{className:"stat-icon",children:"\uD83D\uDCC5"}),(0,t.jsxs)("div",{className:"stat-info",children:[(0,t.jsx)("span",{className:"stat-label",children:"Total de Agendamentos"}),(0,t.jsx)("span",{className:"stat-value",children:m.total})]})]}),(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("div",{className:"stat-icon",children:"✅"}),(0,t.jsxs)("div",{className:"stat-info",children:[(0,t.jsx)("span",{className:"stat-label",children:"Confirmados"}),(0,t.jsx)("span",{className:"stat-value",children:m.confirmados})]})]}),(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("div",{className:"stat-icon",children:"⏳"}),(0,t.jsxs)("div",{className:"stat-info",children:[(0,t.jsx)("span",{className:"stat-label",children:"Pendentes"}),(0,t.jsx)("span",{className:"stat-value",children:m.pendentes})]})]}),(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("div",{className:"stat-icon",children:"\uD83D\uDCB0"}),(0,t.jsxs)("div",{className:"stat-info",children:[(0,t.jsx)("span",{className:"stat-label",children:"Receita Total"}),(0,t.jsxs)("span",{className:"stat-value",children:["R$ ",m.receita.toFixed(2)]})]})]})]}),(0,t.jsxs)("div",{className:"admin-filters",children:[(0,t.jsxs)("button",{className:"filter-btn ".concat("todos"===r?"active":""),onClick:()=>o("todos"),children:["Todos (",m.total,")"]}),(0,t.jsxs)("button",{className:"filter-btn ".concat("pendente"===r?"active":""),onClick:()=>o("pendente"),children:["Pendentes (",m.pendentes,")"]}),(0,t.jsxs)("button",{className:"filter-btn ".concat("confirmado"===r?"active":""),onClick:()=>o("confirmado"),children:["Confirmados (",m.confirmados,")"]})]}),s?(0,t.jsx)("div",{className:"admin-loading",children:"Carregando agendamentos..."}):0===d.length?(0,t.jsx)("div",{className:"admin-empty",children:(0,t.jsx)("p",{children:"Nenhum agendamento encontrado"})}):(0,t.jsx)("div",{className:"admin-appointments",children:d.map(a=>{var e,s;return(0,t.jsxs)("div",{className:"appointment-card",children:[(0,t.jsxs)("div",{className:"appointment-header",children:[(0,t.jsx)("h3",{className:"appointment-service",children:a.servicoNome}),(0,t.jsx)("span",{className:"appointment-status status-".concat((null===(e=a.status)||void 0===e?void 0:e.toLowerCase())||"pendente"),children:a.status})]}),(0,t.jsxs)("div",{className:"appointment-details",children:[(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Cliente:"}),(0,t.jsx)("span",{className:"detail-value",children:a.clienteNome})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Barbeiro:"}),(0,t.jsx)("span",{className:"detail-value",children:a.proprietarioNome})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Data:"}),(0,t.jsx)("span",{className:"detail-value",children:h(a.dataHora)})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Hor\xe1rio:"}),(0,t.jsx)("span",{className:"detail-value",children:u(a.dataHora)})]}),(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Pre\xe7o:"}),(0,t.jsxs)("span",{className:"detail-value price",children:["R$ ",(null===(s=a.precoFinal)||void 0===s?void 0:s.toFixed(2))||"0.00"]})]}),a.observacoes&&(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Observa\xe7\xf5es:"}),(0,t.jsx)("span",{className:"detail-value",children:a.observacoes})]})]})]},a.id)})})]})}s(9473)},9473:function(){}},function(a){a.O(0,[457,971,117,744],function(){return a(a.s=5175)}),_N_E=a.O()}]);