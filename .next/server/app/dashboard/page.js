(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2477:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>d,routeModule:()=>p,tree:()=>c}),r(7015),r(8295),r(5866);var t=r(3191),s=r(8716),o=r(7922),i=r.n(o),n=r(5231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(a,l);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7015)),"D:\\visual\\src\\app\\dashboard\\page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8295)),"D:\\visual\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\visual\\src\\app\\dashboard\\page.jsx"],h="/dashboard/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7386:(e,a,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},7869:(e,a,r)=>{Promise.resolve().then(r.bind(r,3771))},810:()=>{},5047:(e,a,r)=>{"use strict";var t=r(7389);r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}})},3771:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>i});var t=r(326),s=r(7577),o=r(5047);function i(){let[e,a]=(0,s.useState)("novo"),[r,i]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[h,m]=(0,s.useState)(""),[p,u]=(0,s.useState)(""),v=(0,o.useRouter)(),[x,b]=(0,s.useState)({servicoId:"",proprietarioId:"",observacao:""}),[j,g]=(0,s.useState)(new Date),[N,f]=(0,s.useState)(""),[S,y]=(0,s.useState)(!1),[D,k]=(0,s.useState)(null),[C,P]=(0,s.useState)(!1),[I,w]=(0,s.useState)({nome:"",preco:""}),[A,$]=(0,s.useState)(null),E=async()=>{let e=localStorage.getItem("token");if(!e){v.push("/login");return}try{let a=JSON.parse(atob(e.split(".")[1]))["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||"";m(a);let[r,t,s]=await Promise.all([fetch("https://localhost:7037/api/Servicos/todos",{headers:{Authorization:`Bearer ${e}`}}),fetch("https://localhost:7037/api/Proprietarios/todos",{headers:{Authorization:`Bearer ${e}`}}),fetch("https://localhost:7037/api/Agendamento/todos",{headers:{Authorization:`Bearer ${e}`}})]);r.ok&&i(await r.json()),t.ok&&l(await t.json()),s.ok&&d(await s.json())}catch(e){console.error("Erro ao carregar dados:",e)}},T=e=>{u(e),setTimeout(()=>u(""),3e3)},B=e=>{if(!x.proprietarioId)return!1;let[a,r]=e.split(":").map(Number),t=j.toISOString().split("T")[0];return c.some(e=>{if(e.proprietario?.id!==parseInt(x.proprietarioId))return!1;let s=new Date(e.dataHora),o=s.toISOString().split("T")[0],i=s.getUTCHours(),n=s.getUTCMinutes();return t===o&&i===a&&n===r})},_=async e=>{e.preventDefault();let t=localStorage.getItem("token");if(!t){T("⚠️ Voc\xea precisa estar logado para agendar.");return}let s=r.find(e=>e.id===parseInt(x.servicoId));if(!s)return T("⚠️ Selecione um servi\xe7o v\xe1lido.");if(!N)return T("⚠️ Selecione um hor\xe1rio v\xe1lido.");let o=`${j.toISOString().split("T")[0]}T${N}:00Z`,i={proprietarioId:parseInt(x.proprietarioId),servicoId:parseInt(x.servicoId),dataHora:o,observacao:x.observacao||"",precoFinal:parseFloat(s.preco||0),confirmado:!1};try{let e=await fetch("https://localhost:7037/api/Agendamento/criar",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(i)});if(!e.ok){let a=await e.text();T(`❌ Erro: ${a||e.statusText}`);return}T("✅ Agendamento criado com sucesso!"),b({servicoId:"",proprietarioId:"",observacao:""}),f(""),E(),a("meus")}catch(e){console.error("Erro ao criar agendamento:",e),T("❌ Erro ao realizar agendamento.")}},O=async e=>{e.preventDefault();let a=localStorage.getItem("token");if(!I.nome.trim()||!I.preco)return T("⚠️ Preencha nome e pre\xe7o.");try{(await fetch("https://localhost:7037/api/Servicos/criar",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({nome:I.nome,preco:parseFloat(I.preco)})})).ok?(T("✅ Servi\xe7o criado com sucesso!"),w({nome:"",preco:""}),P(!1),E()):T("❌ Erro ao criar servi\xe7o.")}catch(e){console.error(e),T("❌ Falha ao conectar com o servidor.")}},F=async e=>{let a=localStorage.getItem("token");if(confirm("Deseja realmente excluir este servi\xe7o?"))try{(await fetch(`https://localhost:7037/api/Servicos/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?(T("\uD83D\uDDD1️ Servi\xe7o exclu\xeddo!"),E()):T("❌ Erro ao excluir servi\xe7o.")}catch(e){console.error(e)}},R=async e=>{e.preventDefault();let a=localStorage.getItem("token");try{(await fetch(`https://localhost:7037/api/Servicos/${A.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(A)})).ok?(T("\uD83D\uDCBE Servi\xe7o atualizado!"),$(null),E()):T("❌ Erro ao salvar altera\xe7\xf5es.")}catch(e){console.error(e)}};return(0,t.jsxs)("div",{className:"dashboard-container",children:[(0,t.jsxs)("div",{className:"dashboard-header",children:[t.jsx("h1",{className:"dashboard-title",children:"Agendamentos"}),t.jsx("p",{className:"dashboard-subtitle",children:"Agende seu hor\xe1rio com os melhores profissionais"})]}),(0,t.jsxs)("div",{className:"dashboard-tabs",children:[t.jsx("button",{className:`tab-button ${"novo"===e?"active":""}`,onClick:()=>a("novo"),children:"Novo Agendamento"}),t.jsx("button",{className:`tab-button ${"meus"===e?"active":""}`,onClick:()=>a("meus"),children:"Meus Agendamentos"})]}),"novo"===e?t.jsx("div",{className:"dashboard-content",children:(0,t.jsxs)("div",{className:"booking-grid",children:[(0,t.jsxs)("div",{className:"booking-section service-section",style:{position:"relative"},children:[t.jsx("h2",{className:"section-title",children:"Escolha o Servi\xe7o"}),"proprietario"===h.toLowerCase()&&t.jsx("button",{className:"add-service-btn-inside",onClick:()=>P(!0),title:"Adicionar novo servi\xe7o",children:"+"}),t.jsx("div",{className:"services-grid",children:r.map(e=>(0,t.jsxs)("div",{className:`service-card ${parseInt(x.servicoId)===e.id?"selected":""}`,onClick:()=>b({...x,servicoId:e.id}),style:{position:"relative"},children:["proprietario"===h.toLowerCase()&&t.jsx("button",{className:"delete-icon-btn",onClick:a=>{a.stopPropagation(),F(e.id)},title:"Excluir servi\xe7o",children:"\uD83D\uDDD1️"}),t.jsx("h3",{children:e.nome}),(0,t.jsxs)("p",{className:"service-price",children:["R$ ",(e.preco||0).toFixed(2)]})]},e.id))}),C&&t.jsx("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-box",children:[t.jsx("h3",{children:"Adicionar Novo Servi\xe7o"}),(0,t.jsxs)("form",{onSubmit:O,children:[t.jsx("input",{type:"text",placeholder:"Nome do servi\xe7o",value:I.nome,onChange:e=>w({...I,nome:e.target.value}),required:!0}),t.jsx("input",{type:"number",step:"0.01",placeholder:"Pre\xe7o (R$)",value:I.preco,onChange:e=>w({...I,preco:e.target.value}),required:!0}),(0,t.jsxs)("div",{className:"modal-actions",children:[t.jsx("button",{type:"button",className:"cancelar-btn",onClick:()=>P(!1),children:"Cancelar"}),t.jsx("button",{type:"submit",className:"confirmar-btn",children:"Adicionar"})]})]})]})})]}),C&&t.jsx("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-box",children:[t.jsx("h3",{children:"Adicionar Novo Servi\xe7o"}),(0,t.jsxs)("form",{onSubmit:O,children:[t.jsx("input",{type:"text",placeholder:"Nome do servi\xe7o",value:I.nome,onChange:e=>w({...I,nome:e.target.value}),required:!0}),t.jsx("input",{type:"number",step:"0.01",placeholder:"Pre\xe7o (R$)",value:I.preco,onChange:e=>w({...I,preco:e.target.value}),required:!0}),(0,t.jsxs)("div",{className:"modal-actions",children:[t.jsx("button",{type:"button",className:"cancelar-btn",onClick:()=>P(!1),children:"Cancelar"}),t.jsx("button",{type:"submit",className:"confirmar-btn",children:"Adicionar"})]})]})]})}),A&&t.jsx("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-box",children:[t.jsx("h3",{children:"Editar Servi\xe7o"}),(0,t.jsxs)("form",{onSubmit:R,children:[t.jsx("input",{type:"text",value:A.nome,onChange:e=>$({...A,nome:e.target.value})}),t.jsx("input",{type:"number",step:"0.01",value:A.preco,onChange:e=>$({...A,preco:e.target.value})}),(0,t.jsxs)("div",{className:"modal-actions",children:[t.jsx("button",{type:"button",className:"cancelar-btn",onClick:()=>$(null),children:"Cancelar"}),t.jsx("button",{type:"submit",className:"confirmar-btn",children:"Salvar"})]})]})]})}),(0,t.jsxs)("div",{className:"booking-section",children:[t.jsx("h2",{className:"section-title",children:"Escolha o Barbeiro"}),t.jsx("div",{className:"barbers-grid",children:n.map(e=>(0,t.jsxs)("div",{className:`barber-card ${parseInt(x.proprietarioId)===e.id?"selected":""}`,onClick:()=>b({...x,proprietarioId:e.id}),children:[t.jsx("div",{className:"barber-avatar",children:e.nome?.charAt(0)||"?"}),t.jsx("h3",{children:e.nome})]},e.id))})]}),(0,t.jsxs)("div",{className:"booking-section",children:[t.jsx("h2",{className:"section-title",children:"Escolha a Data"}),(()=>{let e=new Date,a=new Date(j.getFullYear(),j.getMonth(),1),r=new Date(j.getFullYear(),j.getMonth()+1,0),s=[],o=a.getDay();for(let e=0;e<o;e++)s.push(t.jsx("div",{className:"calendar-day empty"},`empty-${e}`));for(let a=1;a<=r.getDate();a++){let r=new Date(j.getFullYear(),j.getMonth(),a),o=r.toDateString()===j.toDateString(),i=r<e.setHours(0,0,0,0);s.push(t.jsx("div",{className:`calendar-day ${o?"selected":""} ${i?"past":""}`,onClick:()=>!i&&g(r),children:a},a))}return(0,t.jsxs)("div",{className:"calendar-container fixed-calendar",children:[(0,t.jsxs)("div",{className:"calendar-header",children:[t.jsx("button",{onClick:()=>g(new Date(j.getFullYear(),j.getMonth()-1)),className:"calendar-nav",children:"←"}),t.jsx("h3",{children:j.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),t.jsx("button",{onClick:()=>g(new Date(j.getFullYear(),j.getMonth()+1)),className:"calendar-nav",children:"→"})]}),t.jsx("div",{className:"calendar-weekdays",children:["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map(e=>t.jsx("div",{className:"weekday",children:e},e))}),t.jsx("div",{className:"calendar-grid",children:s})]})})()]}),(0,t.jsxs)("div",{className:"booking-section",children:[t.jsx("h2",{className:"section-title",children:"Escolha o Hor\xe1rio"}),t.jsx("div",{className:"time-grid",children:["09:00","09:30","10:00","10:30","11:00","11:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30"].map(e=>{let a=B(e);return t.jsx("button",{className:`time-slot ${N===e?"selected":""} ${a?"disabled":""}`,onClick:()=>!a&&f(e),disabled:a,title:a?"Hor\xe1rio j\xe1 agendado":"Dispon\xedvel",children:e},e)})})]}),(0,t.jsxs)("div",{className:"booking-section full-width",children:[t.jsx("h2",{className:"section-title",children:"Observa\xe7\xf5es (Opcional)"}),t.jsx("textarea",{className:"barber-textarea",placeholder:"Alguma prefer\xeancia ou observa\xe7\xe3o?",value:x.observacao,onChange:e=>b({...x,observacao:e.target.value}),rows:"4"})]}),t.jsx("div",{className:"booking-section full-width",children:t.jsx("button",{className:"barber-button",onClick:_,disabled:!x.servicoId||!x.proprietarioId||!N,children:"Confirmar Agendamento"})})]})}):t.jsx("div",{className:"dashboard-content",children:t.jsx("div",{className:"appointments-list",children:0===c.length?t.jsx("div",{className:"empty-state",children:t.jsx("p",{children:"Voc\xea ainda n\xe3o tem agendamentos."})}):c.map(e=>(0,t.jsxs)("div",{className:"appointment-card",children:[(0,t.jsxs)("div",{className:"appointment-header",children:[t.jsx("h3",{children:e.servico?.nome||"Servi\xe7o"}),t.jsx("span",{className:`status-badge ${e.confirmado?"confirmed":"pending"}`,children:e.confirmado?"Confirmado":"Pendente"})]}),(0,t.jsxs)("div",{className:"appointment-details",children:[(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Barbeiro:"})," ",e.proprietario?.nome||"N/A"]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Data/Hora:"})," ",new Date(e.dataHora).toLocaleString("pt-BR")]}),(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Pre\xe7o:"})," R$ ",(e.precoFinal||0).toFixed(2)]}),e.observacao&&(0,t.jsxs)("p",{children:[t.jsx("strong",{children:"Obs:"})," ",e.observacao]})]})]},e.id))})}),"Proprietario"===h&&t.jsx("button",{className:"admin-button",onClick:()=>v.push("/admin/agendamentos"),children:"\uD83D\uDCCB Ver Todos (Admin)"}),p&&t.jsx("div",{className:"toast",children:p})]})}r(8910),r(7997)},7015:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>t});let t=(0,r(8570).createProxy)(String.raw`D:\visual\src\app\dashboard\page.jsx#default`)},8295:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>o,metadata:()=>s});var t=r(9510);r(8903);let s={title:"Barbearia Premium",description:"Sistema de agendamento"};function o({children:e}){return t.jsx("html",{lang:"pt-BR",children:t.jsx("body",{children:e})})}},8910:()=>{},7997:()=>{},8903:()=>{}};var a=require("../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[819],()=>r(2477));module.exports=t})();